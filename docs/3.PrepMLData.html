---

title: This notebook is the primary notebook to take data in a per region format and transform it in to a format appropriate for ML problems


keywords: fastai
sidebar: home_sidebar



nb_path: "DataPipelineNotebooks/3.PrepMLData.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: DataPipelineNotebooks/3.PrepMLData.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-structure">Data structure<a class="anchor-link" href="#Data-structure"> </a></h1><p>OAPMLData\
    CleanedForecastsNWAC_CAIC_UAC.V1.2013-2020.csv #labels downloaded from <a href="https://oapstorageprod.blob.core.windows.net/oap-training-data/Data/V1.1FeaturesWithLabels2013-2020.zip">https://oapstorageprod.blob.core.windows.net/oap-training-data/Data/V1.1FeaturesWithLabels2013-2020.zip</a></p>

<pre><code>1.RawWeatherData/
    gfs/
        &lt;season&gt;/
            /&lt;state or country&gt;/
2.GFSDaily(x)Interpolation/
3.GFSFiltered(x)Interpolation/
4.GFSFiltered(x)InterpolationZarr/
5.MLData</code></pre>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_root</span> <span class="o">=</span> <span class="s1">&#39;/media/scottcha/E1/Data/OAPMLData/&#39;</span>
<span class="c1">#data_root = &#39;/media/scottcha/E1/Data/Temp/Tutorial/&#39;</span>
<span class="n">interpolation</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PrepML" class="doc_header"><code>class</code> <code>PrepML</code><a href="https://github.com/scottcha/openavalancheproject/tree/master/openavalancheproject/prep_ml.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PrepML</code>(<strong><code>data_root</code></strong>, <strong><code>interpolate</code></strong>=<em><code>1</code></em>, <strong><code>date_start</code></strong>=<em><code>'2015-11-01'</code></em>, <strong><code>date_end</code></strong>=<em><code>'2020-04-30'</code></em>, <strong><code>date_train_test_cutoff</code></strong>=<em><code>'2019-11-01'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">season</span> <span class="o">=</span> <span class="s1">&#39;15-16&#39;</span>
<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;Washington&#39;</span>

<span class="n">interpolate</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#interpolation factor: whether we can to augment the data through lat/lon interpolation; 1 no interpolation, 4 is 4x interpolation</span>

<span class="n">data_root</span> <span class="o">=</span> <span class="s1">&#39;/media/scottcha/E1/Data/OAPMLData/&#39;</span>

<span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1">#number of parallel processes, this processing is IO bound so don&#39;t set this too high</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pml</span> <span class="o">=</span> <span class="n">PrepML</span><span class="p">(</span><span class="n">data_root</span><span class="p">,</span> <span class="n">interpolate</span><span class="p">,</span> <span class="n">date_start</span><span class="o">=</span><span class="s1">&#39;2015-11-01&#39;</span><span class="p">,</span> <span class="n">date_end</span><span class="o">=</span><span class="s1">&#39;2016-04-30&#39;</span><span class="p">,</span> <span class="n">date_train_test_cutoff</span><span class="o">=</span><span class="s1">&#39;2016-04-01&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">pml</span><span class="o">.</span><span class="n">prep_labels</span><span class="p">()</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pml</span><span class="o">.</span><span class="n">generate_train_test_local</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">num_variables</span><span class="o">=</span><span class="mi">978</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

